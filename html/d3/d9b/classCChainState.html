<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin: CChainState Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d7/d88/classCChainState-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CChainState Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../db/d38/validation_8h_source.html">validation.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3703bd0134dfe07b5ea2398ebe69089d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d38/validation_8h.html#a6b962fe256607627c8140021ae7a23e1">BlockMap</a> <a class="el" href="../../dd/d7d/validation_8cpp.html#aeccc8c1b7fffcca5d6c0d8486cc9b48b">mapBlockIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a3703bd0134dfe07b5ea2398ebe69089d">GUARDED_BY</a> (<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a3703bd0134dfe07b5ea2398ebe69089d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25df87c65c89c79a4061f28c09599856"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a25df87c65c89c79a4061f28c09599856">LoadBlockIndex</a> (const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;consensus_params, <a class="el" href="../../d6/d80/classCBlockTreeDB.html">CBlockTreeDB</a> &amp;blocktree) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a25df87c65c89c79a4061f28c09599856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9fea6ee67de000164699736195dd2e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#acd9fea6ee67de000164699736195dd2e">FlushStateToDisk</a> (const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, <a class="el" href="../../db/d38/validation_8h.html#ae2877520fcc46d869b4f5e9768227e25">FlushStateMode</a> mode, int nManualPruneHeight=0)</td></tr>
<tr class="separator:acd9fea6ee67de000164699736195dd2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae779736948817631aa6fee5d5d1377a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ae779736948817631aa6fee5d5d1377a8">ForceFlushStateToDisk</a> ()</td></tr>
<tr class="memdesc:ae779736948817631aa6fee5d5d1377a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unconditionally flush all changes to disk.  <a href="#ae779736948817631aa6fee5d5d1377a8">More...</a><br /></td></tr>
<tr class="separator:ae779736948817631aa6fee5d5d1377a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c8d4028eff1c760111280f977ad0c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a62c8d4028eff1c760111280f977ad0c7">PruneAndFlush</a> ()</td></tr>
<tr class="separator:a62c8d4028eff1c760111280f977ad0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8c69693e2a23c13cf7bbc568435bef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ada8c69693e2a23c13cf7bbc568435bef">ActivateBestChain</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; pblock) <a class="el" href="../../db/d6d/threadsafety_8h.html#a6bb97382864d0bd2cd4dd5191bb03f6c">LOCKS_EXCLUDED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:ada8c69693e2a23c13cf7bbc568435bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab70c11d94a3f6e5cae415521437ef627"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ab70c11d94a3f6e5cae415521437ef627">AcceptBlockHeader</a> (const <a class="el" href="../../d2/d93/classCBlockHeader.html">CBlockHeader</a> &amp;block, <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> **ppindex) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:ab70c11d94a3f6e5cae415521437ef627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5e98600ce5a2b8ed3087972d1ee5a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a2a5e98600ce5a2b8ed3087972d1ee5a3">AcceptBlock</a> (const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;pblock, <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> **ppindex, bool fRequested, const <a class="el" href="../../dd/d75/structFlatFilePos.html">FlatFilePos</a> *dbp, bool *fNewBlock) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a2a5e98600ce5a2b8ed3087972d1ee5a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c2802e12d40109c2189bfa8a5e0e8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d38/validation_8h.html#aeaef80b01ee5387f474a63ed23c9cc50">DisconnectResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a84c2802e12d40109c2189bfa8a5e0e8f">DisconnectBlock</a> (const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;block, const <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex, <a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;view)</td></tr>
<tr class="separator:a84c2802e12d40109c2189bfa8a5e0e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a01f2d89b7a40b5341083aa522a1e2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a06a01f2d89b7a40b5341083aa522a1e2">ConnectBlock</a> (const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;block, <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex, <a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;view, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, bool fJustCheck=false) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a06a01f2d89b7a40b5341083aa522a1e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e141761d3999ddc1ae9ba5db93033c2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a6e141761d3999ddc1ae9ba5db93033c2">DisconnectTip</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d0/d31/structDisconnectedBlockTransactions.html">DisconnectedBlockTransactions</a> *disconnectpool) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a></td></tr>
<tr class="separator:a6e141761d3999ddc1ae9ba5db93033c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c2bc46ff4824c106a100d684fd5f4dd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a1c2bc46ff4824c106a100d684fd5f4dd">PreciousBlock</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;params, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex) <a class="el" href="../../db/d6d/threadsafety_8h.html#a6bb97382864d0bd2cd4dd5191bb03f6c">LOCKS_EXCLUDED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a1c2bc46ff4824c106a100d684fd5f4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b63957193449bfc696e9a4221ab764"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ab0b63957193449bfc696e9a4221ab764">InvalidateBlock</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex) <a class="el" href="../../db/d6d/threadsafety_8h.html#a6bb97382864d0bd2cd4dd5191bb03f6c">LOCKS_EXCLUDED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:ab0b63957193449bfc696e9a4221ab764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e35ac867678ce71b05ff271c44bde29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a6e35ac867678ce71b05ff271c44bde29">ResetBlockFailureFlags</a> (<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a6e35ac867678ce71b05ff271c44bde29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219bb793d4d3b0a095ccc47c45bc5b83"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a219bb793d4d3b0a095ccc47c45bc5b83">ReplayBlocks</a> (const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;params, <a class="el" href="../../de/d73/classCCoinsView.html">CCoinsView</a> *view)</td></tr>
<tr class="separator:a219bb793d4d3b0a095ccc47c45bc5b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a02c4acc020706461abb4f663f3a23d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a0a02c4acc020706461abb4f663f3a23d">RewindBlockIndex</a> (const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;params) <a class="el" href="../../db/d6d/threadsafety_8h.html#a6bb97382864d0bd2cd4dd5191bb03f6c">LOCKS_EXCLUDED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a0a02c4acc020706461abb4f663f3a23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6beb735dce3a8f0182660c04789df961"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a6beb735dce3a8f0182660c04789df961">LoadGenesisBlock</a> (const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams)</td></tr>
<tr class="separator:a6beb735dce3a8f0182660c04789df961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5ba911dca1f0d59781b9e63a607cd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a6c5ba911dca1f0d59781b9e63a607cd6">PruneBlockIndexCandidates</a> ()</td></tr>
<tr class="separator:a6c5ba911dca1f0d59781b9e63a607cd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a807d9f23f63726267a1c62bf9c9eecef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a807d9f23f63726267a1c62bf9c9eecef">UnloadBlockIndex</a> ()</td></tr>
<tr class="separator:a807d9f23f63726267a1c62bf9c9eecef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa0ff1ebd8453000020efa9055d7896e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#aaa0ff1ebd8453000020efa9055d7896e">IsInitialBlockDownload</a> () const</td></tr>
<tr class="separator:aaa0ff1ebd8453000020efa9055d7896e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad460a678a49106417e68b5c416afd371"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dba/classCChain.html">CChain</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ad460a678a49106417e68b5c416afd371">m_chain</a></td></tr>
<tr class="separator:ad460a678a49106417e68b5c416afd371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318040c11336b79eddc71e1d3b176f2a"><td class="memItemLeft" align="right" valign="top">std::multimap&lt; <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a318040c11336b79eddc71e1d3b176f2a">mapBlocksUnlinked</a></td></tr>
<tr class="separator:a318040c11336b79eddc71e1d3b176f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ae491f2e6b031587a5ad35fdafe546"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ae0ae491f2e6b031587a5ad35fdafe546">pindexBestInvalid</a> = nullptr</td></tr>
<tr class="separator:ae0ae491f2e6b031587a5ad35fdafe546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c81c37ef6c30da848aaedc73da0bbe3"><td class="memItemLeft" align="right" valign="top">bool ::<a class="el" href="../../db/d38/validation_8h.html#abc71256f703e47c9254093e32ed2994c">mempool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a8c81c37ef6c30da848aaedc73da0bbe3">cs</a></td></tr>
<tr class="separator:a8c81c37ef6c30da848aaedc73da0bbe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a960fd0265f72c15e7c2890d69ddcabb4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a960fd0265f72c15e7c2890d69ddcabb4">ActivateBestChainStep</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindexMostWork, const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;pblock, bool &amp;fInvalidFound, <a class="el" href="../../d0/de0/classConnectTrace.html">ConnectTrace</a> &amp;connectTrace) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a></td></tr>
<tr class="separator:a960fd0265f72c15e7c2890d69ddcabb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920fab1b33e2f20bb0ccbe912b149c38"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a920fab1b33e2f20bb0ccbe912b149c38">ConnectTip</a> (<a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;chainparams, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindexNew, const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;pblock, <a class="el" href="../../d0/de0/classConnectTrace.html">ConnectTrace</a> &amp;connectTrace, <a class="el" href="../../d0/d31/structDisconnectedBlockTransactions.html">DisconnectedBlockTransactions</a> &amp;disconnectpool) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a></td></tr>
<tr class="separator:a920fab1b33e2f20bb0ccbe912b149c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75381aa4f08cbb957a2158dd852602a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a75381aa4f08cbb957a2158dd852602a8">AddToBlockIndex</a> (const <a class="el" href="../../d2/d93/classCBlockHeader.html">CBlockHeader</a> &amp;block) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:a75381aa4f08cbb957a2158dd852602a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23edc8172cd1b029dbec82bafacd33e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ab23edc8172cd1b029dbec82bafacd33e">InsertBlockIndex</a> (const <a class="el" href="../../d2/d86/classuint256.html">uint256</a> &amp;hash) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:ab23edc8172cd1b029dbec82bafacd33e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48cfb3ace8393f98f940b02876377f97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a48cfb3ace8393f98f940b02876377f97">CheckBlockIndex</a> (const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;consensusParams)</td></tr>
<tr class="separator:a48cfb3ace8393f98f940b02876377f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece188b05b5cfe3d67f35992a6fa7d77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#aece188b05b5cfe3d67f35992a6fa7d77">InvalidBlockFound</a> (<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex, const <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;state) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:aece188b05b5cfe3d67f35992a6fa7d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b50c7b3a7604d312946431e7c91bb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#af5b50c7b3a7604d312946431e7c91bb5">FindMostWorkChain</a> () <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:af5b50c7b3a7604d312946431e7c91bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6aa385b3b9c30ca0fb9981e889280de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#af6aa385b3b9c30ca0fb9981e889280de">ReceivedBlockTransactions</a> (const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;block, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindexNew, const <a class="el" href="../../dd/d75/structFlatFilePos.html">FlatFilePos</a> &amp;pos, const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;consensusParams) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:af6aa385b3b9c30ca0fb9981e889280de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac231f6529bc41aea7917d0716d0c9d1a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ac231f6529bc41aea7917d0716d0c9d1a">RollforwardBlock</a> (const <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *pindex, <a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;inputs, const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;params) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="separator:ac231f6529bc41aea7917d0716d0c9d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8c5ba0914352028dd53ec494887da34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#aa8c5ba0914352028dd53ec494887da34">EraseBlockData</a> (<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *index) <a class="el" href="../../db/d6d/threadsafety_8h.html#a0e2e86b0f11d9778240b0a0b263047b1">EXCLUSIVE_LOCKS_REQUIRED</a>(<a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>)</td></tr>
<tr class="memdesc:aa8c5ba0914352028dd53ec494887da34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a block as not having block data.  <a href="#aa8c5ba0914352028dd53ec494887da34">More...</a><br /></td></tr>
<tr class="separator:aa8c5ba0914352028dd53ec494887da34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a528c14be4a2a7c6837a2d099b2ad7ef7"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *, <a class="el" href="../../df/dd8/structCBlockIndexWorkComparator.html">CBlockIndexWorkComparator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a528c14be4a2a7c6837a2d099b2ad7ef7">setBlockIndexCandidates</a></td></tr>
<tr class="separator:a528c14be4a2a7c6837a2d099b2ad7ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9e45b0fb23eacbbc2c0675f429d5c3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d6b/sync_8h.html#a8019a4144dc54f3a305830f7abd2dbc1">CCriticalSection</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#ad9e45b0fb23eacbbc2c0675f429d5c3b">cs_nBlockSequenceId</a></td></tr>
<tr class="separator:ad9e45b0fb23eacbbc2c0675f429d5c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c18ee587d1d516d12a193235eeb1cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a04c18ee587d1d516d12a193235eeb1cd">nBlockSequenceId</a> = 1</td></tr>
<tr class="separator:a04c18ee587d1d516d12a193235eeb1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf4846ebb330ea7ad36adb058ba2b859"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#aaf4846ebb330ea7ad36adb058ba2b859">nBlockReverseSequenceId</a> = -1</td></tr>
<tr class="separator:aaf4846ebb330ea7ad36adb058ba2b859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11b2d82dd158e9e50136417c0e672947"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/de4/classarith__uint256.html">arith_uint256</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a11b2d82dd158e9e50136417c0e672947">nLastPreciousChainwork</a> = 0</td></tr>
<tr class="separator:a11b2d82dd158e9e50136417c0e672947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c29388d6805442893089beaf96c4a7"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a52c29388d6805442893089beaf96c4a7">m_failed_blocks</a></td></tr>
<tr class="separator:a52c29388d6805442893089beaf96c4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de325123fd907fea8398fde92e5a6b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d6b/sync_8h.html#a8019a4144dc54f3a305830f7abd2dbc1">CCriticalSection</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a7de325123fd907fea8398fde92e5a6b1">m_cs_chainstate</a></td></tr>
<tr class="separator:a7de325123fd907fea8398fde92e5a6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e3b18d6c0a7e3f1a5fbf752c3a8c09a"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d9b/classCChainState.html#a0e3b18d6c0a7e3f1a5fbf752c3a8c09a">m_cached_finished_ibd</a> {false}</td></tr>
<tr class="separator:a0e3b18d6c0a7e3f1a5fbf752c3a8c09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="../../d3/d9b/classCChainState.html">CChainState</a> stores and provides an API to update our local knowledge of the current best chain and header tree.</p>
<p>It generally provides access to the current block tree, as well as functions to provide new data, which it will appropriately validate and incorporate in its state as necessary.</p>
<p>Eventually, the API here is targeted at being exposed externally as a consumable libconsensus library, so any functions added must only call other class member functions, pure functions in other parts of the consensus library, callbacks via the validation interface, or read/write-to-disk functions (eventually this will also be via callbacks). </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a2a5e98600ce5a2b8ed3087972d1ee5a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a5e98600ce5a2b8ed3087972d1ee5a3">&#9670;&nbsp;</a></span>AcceptBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::AcceptBlock </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pblock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> **&#160;</td>
          <td class="paramname"><em>ppindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fRequested</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dd/d75/structFlatFilePos.html">FlatFilePos</a> *&#160;</td>
          <td class="paramname"><em>dbp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>fNewBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Store block on disk. If dbp is non-nullptr, the file is known to already reside on disk </p>

</div>
</div>
<a id="ab70c11d94a3f6e5cae415521437ef627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab70c11d94a3f6e5cae415521437ef627">&#9670;&nbsp;</a></span>AcceptBlockHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::AcceptBlockHeader </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/d93/classCBlockHeader.html">CBlockHeader</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> **&#160;</td>
          <td class="paramname"><em>ppindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If a block header hasn't already been seen, call CheckBlockHeader on it, ensure that it doesn't descend from an invalid block, and then add it to mapBlockIndex. </p>

</div>
</div>
<a id="ada8c69693e2a23c13cf7bbc568435bef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8c69693e2a23c13cf7bbc568435bef">&#9670;&nbsp;</a></span>ActivateBestChain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::ActivateBestChain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt;&#160;</td>
          <td class="paramname"><em>pblock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the best chain active, in multiple steps. The result is either failure or an activated best chain. pblock is either nullptr or a pointer to a block that is already loaded (to avoid loading it again from disk).</p>
<p>ActivateBestChain is split into steps (see ActivateBestChainStep) so that we avoid holding cs_main for an extended period of time; the length of this call may be quite long during reindexing or a substantial reorg. </p>

</div>
</div>
<a id="a960fd0265f72c15e7c2890d69ddcabb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a960fd0265f72c15e7c2890d69ddcabb4">&#9670;&nbsp;</a></span>ActivateBestChainStep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::ActivateBestChainStep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindexMostWork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pblock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>fInvalidFound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/de0/classConnectTrace.html">ConnectTrace</a> &amp;&#160;</td>
          <td class="paramname"><em>connectTrace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Try to make some progress towards making pindexMostWork the active block. pblock is either nullptr or a pointer to a <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> corresponding to pindexMostWork. </p>

</div>
</div>
<a id="a75381aa4f08cbb957a2158dd852602a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75381aa4f08cbb957a2158dd852602a8">&#9670;&nbsp;</a></span>AddToBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> * CChainState::AddToBlockIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/d93/classCBlockHeader.html">CBlockHeader</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a48cfb3ace8393f98f940b02876377f97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48cfb3ace8393f98f940b02876377f97">&#9670;&nbsp;</a></span>CheckBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::CheckBlockIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;&#160;</td>
          <td class="paramname"><em>consensusParams</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make various assertions about the state of the block index.</p>
<p>By default this only executes fully when using the Regtest chain; see: fCheckBlockIndex. </p>

</div>
</div>
<a id="a06a01f2d89b7a40b5341083aa522a1e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a01f2d89b7a40b5341083aa522a1e2">&#9670;&nbsp;</a></span>ConnectBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::ConnectBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;&#160;</td>
          <td class="paramname"><em>view</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fJustCheck</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply the effects of this block (with given index) on the UTXO set represented by coins. Validity checks that depend on the UTXO set are also done; <a class="el" href="../../d3/d9b/classCChainState.html#a06a01f2d89b7a40b5341083aa522a1e2">ConnectBlock()</a> can fail if those validity checks fail (among other reasons). </p>

</div>
</div>
<a id="a920fab1b33e2f20bb0ccbe912b149c38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a920fab1b33e2f20bb0ccbe912b149c38">&#9670;&nbsp;</a></span>ConnectTip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::ConnectTip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindexNew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>pblock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/de0/classConnectTrace.html">ConnectTrace</a> &amp;&#160;</td>
          <td class="paramname"><em>connectTrace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d31/structDisconnectedBlockTransactions.html">DisconnectedBlockTransactions</a> &amp;&#160;</td>
          <td class="paramname"><em>disconnectpool</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Connect a new block to m_chain. pblock is either nullptr or a pointer to a <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> corresponding to pindexNew, to bypass loading it again from disk.</p>
<p>The block is added to connectTrace if connection succeeds. </p>

</div>
</div>
<a id="a84c2802e12d40109c2189bfa8a5e0e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c2802e12d40109c2189bfa8a5e0e8f">&#9670;&nbsp;</a></span>DisconnectBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d38/validation_8h.html#aeaef80b01ee5387f474a63ed23c9cc50">DisconnectResult</a> CChainState::DisconnectBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;&#160;</td>
          <td class="paramname"><em>view</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Undo the effects of this block (with given index) on the UTXO set represented by coins. When FAILED is returned, view is left in an indeterminate state. </p>

</div>
</div>
<a id="a6e141761d3999ddc1ae9ba5db93033c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e141761d3999ddc1ae9ba5db93033c2">&#9670;&nbsp;</a></span>DisconnectTip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::DisconnectTip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d31/structDisconnectedBlockTransactions.html">DisconnectedBlockTransactions</a> *&#160;</td>
          <td class="paramname"><em>disconnectpool</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Disconnect m_chain's tip. After calling, the mempool will be in an inconsistent state, with transactions from disconnected blocks being added to disconnectpool. You should make the mempool consistent again by calling UpdateMempoolForReorg. with cs_main held.</p>
<p>If disconnectpool is nullptr, then no disconnected transactions are added to disconnectpool (note that the caller is responsible for mempool consistency in any case). </p>

</div>
</div>
<a id="aa8c5ba0914352028dd53ec494887da34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8c5ba0914352028dd53ec494887da34">&#9670;&nbsp;</a></span>EraseBlockData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::EraseBlockData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark a block as not having block data. </p>
<p>Helper for <a class="el" href="../../d3/d9b/classCChainState.html#a0a02c4acc020706461abb4f663f3a23d">CChainState::RewindBlockIndex</a>. </p>

</div>
</div>
<a id="af5b50c7b3a7604d312946431e7c91bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b50c7b3a7604d312946431e7c91bb5">&#9670;&nbsp;</a></span>FindMostWorkChain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> * CChainState::FindMostWorkChain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the tip of the chain with the most work in it, that isn't known to be invalid (it's however far from certain to be valid). </p>

</div>
</div>
<a id="acd9fea6ee67de000164699736195dd2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd9fea6ee67de000164699736195dd2e">&#9670;&nbsp;</a></span>FlushStateToDisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::FlushStateToDisk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d38/validation_8h.html#ae2877520fcc46d869b4f5e9768227e25">FlushStateMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nManualPruneHeight</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the on-disk chain state. The caches and indexes are flushed depending on the mode we're called with if they're too large, if it's been a while since the last write, or always and in all cases if we're in prune mode and are deleting files.</p>
<p>If <a class="el" href="../../db/d38/validation_8h.html#ae2877520fcc46d869b4f5e9768227e25ab50339a10e1de285ac99d4c3990b8693">FlushStateMode::NONE</a> is used, then FlushStateToDisk(...) won't do anything besides checking if we need to prune. </p>

</div>
</div>
<a id="ae779736948817631aa6fee5d5d1377a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae779736948817631aa6fee5d5d1377a8">&#9670;&nbsp;</a></span>ForceFlushStateToDisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::ForceFlushStateToDisk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unconditionally flush all changes to disk. </p>

</div>
</div>
<a id="a3703bd0134dfe07b5ea2398ebe69089d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3703bd0134dfe07b5ea2398ebe69089d">&#9670;&nbsp;</a></span>GUARDED_BY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d38/validation_8h.html#a6b962fe256607627c8140021ae7a23e1">BlockMap</a> <a class="el" href="../../dd/d7d/validation_8cpp.html#aeccc8c1b7fffcca5d6c0d8486cc9b48b">mapBlockIndex</a> CChainState::GUARDED_BY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d35/validationinterface_8h.html#a1ed8285f0fe3c6799c53265ce72552c8">cs_main</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab23edc8172cd1b029dbec82bafacd33e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab23edc8172cd1b029dbec82bafacd33e">&#9670;&nbsp;</a></span>InsertBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> * CChainState::InsertBlockIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/d86/classuint256.html">uint256</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a new block index entry for a given block hash </p>

</div>
</div>
<a id="ab0b63957193449bfc696e9a4221ab764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b63957193449bfc696e9a4221ab764">&#9670;&nbsp;</a></span>InvalidateBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::InvalidateBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aece188b05b5cfe3d67f35992a6fa7d77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece188b05b5cfe3d67f35992a6fa7d77">&#9670;&nbsp;</a></span>InvalidBlockFound()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::InvalidBlockFound </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aaa0ff1ebd8453000020efa9055d7896e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa0ff1ebd8453000020efa9055d7896e">&#9670;&nbsp;</a></span>IsInitialBlockDownload()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::IsInitialBlockDownload </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether we are doing an initial block download (synchronizing from disk or network) </p>

</div>
</div>
<a id="a25df87c65c89c79a4061f28c09599856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25df87c65c89c79a4061f28c09599856">&#9670;&nbsp;</a></span>LoadBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::LoadBlockIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;&#160;</td>
          <td class="paramname"><em>consensus_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d80/classCBlockTreeDB.html">CBlockTreeDB</a> &amp;&#160;</td>
          <td class="paramname"><em>blocktree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6beb735dce3a8f0182660c04789df961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6beb735dce3a8f0182660c04789df961">&#9670;&nbsp;</a></span>LoadGenesisBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::LoadGenesisBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>chainparams</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1c2bc46ff4824c106a100d684fd5f4dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c2bc46ff4824c106a100d684fd5f4dd">&#9670;&nbsp;</a></span>PreciousBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::PreciousBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d71/classCValidationState.html">CValidationState</a> &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a62c8d4028eff1c760111280f977ad0c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c8d4028eff1c760111280f977ad0c7">&#9670;&nbsp;</a></span>PruneAndFlush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::PruneAndFlush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prune blockfiles from the disk if necessary and then flush chainstate changes if we pruned. </p>

</div>
</div>
<a id="a6c5ba911dca1f0d59781b9e63a607cd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5ba911dca1f0d59781b9e63a607cd6">&#9670;&nbsp;</a></span>PruneBlockIndexCandidates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::PruneBlockIndexCandidates </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete all entries in setBlockIndexCandidates that are worse than the current tip. </p>

</div>
</div>
<a id="af6aa385b3b9c30ca0fb9981e889280de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6aa385b3b9c30ca0fb9981e889280de">&#9670;&nbsp;</a></span>ReceivedBlockTransactions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::ReceivedBlockTransactions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/d28/classCBlock.html">CBlock</a> &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindexNew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dd/d75/structFlatFilePos.html">FlatFilePos</a> &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d55/structConsensus_1_1Params.html">Consensus::Params</a> &amp;&#160;</td>
          <td class="paramname"><em>consensusParams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mark a block as having its data received and checked (up to BLOCK_VALID_TRANSACTIONS). </p>

</div>
</div>
<a id="a219bb793d4d3b0a095ccc47c45bc5b83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a219bb793d4d3b0a095ccc47c45bc5b83">&#9670;&nbsp;</a></span>ReplayBlocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::ReplayBlocks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d73/classCCoinsView.html">CCoinsView</a> *&#160;</td>
          <td class="paramname"><em>view</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e35ac867678ce71b05ff271c44bde29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e35ac867678ce71b05ff271c44bde29">&#9670;&nbsp;</a></span>ResetBlockFailureFlags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::ResetBlockFailureFlags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a02c4acc020706461abb4f663f3a23d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a02c4acc020706461abb4f663f3a23d">&#9670;&nbsp;</a></span>RewindBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::RewindBlockIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac231f6529bc41aea7917d0716d0c9d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac231f6529bc41aea7917d0716d0c9d1a">&#9670;&nbsp;</a></span>RollforwardBlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CChainState::RollforwardBlock </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> *&#160;</td>
          <td class="paramname"><em>pindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d49/classCCoinsViewCache.html">CCoinsViewCache</a> &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d9b/classCChainParams.html">CChainParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply the effects of a block on the utxo cache, ignoring that it may already have been applied. </p>

</div>
</div>
<a id="a807d9f23f63726267a1c62bf9c9eecef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a807d9f23f63726267a1c62bf9c9eecef">&#9670;&nbsp;</a></span>UnloadBlockIndex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CChainState::UnloadBlockIndex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8c81c37ef6c30da848aaedc73da0bbe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c81c37ef6c30da848aaedc73da0bbe3">&#9670;&nbsp;</a></span>cs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d38/validation_8h.html#abc71256f703e47c9254093e32ed2994c">bool::mempool</a> CChainState::cs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9e45b0fb23eacbbc2c0675f429d5c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9e45b0fb23eacbbc2c0675f429d5c3b">&#9670;&nbsp;</a></span>cs_nBlockSequenceId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d6b/sync_8h.html#a8019a4144dc54f3a305830f7abd2dbc1">CCriticalSection</a> CChainState::cs_nBlockSequenceId</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Every received block is assigned a unique and increasing identifier, so we know which one to give priority in case of a fork. </p>

</div>
</div>
<a id="a0e3b18d6c0a7e3f1a5fbf752c3a8c09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e3b18d6c0a7e3f1a5fbf752c3a8c09a">&#9670;&nbsp;</a></span>m_cached_finished_ibd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; CChainState::m_cached_finished_ibd {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether this chainstate is undergoing initial block download.</p>
<p>Mutable because we need to be able to mark <a class="el" href="../../d3/d9b/classCChainState.html#aaa0ff1ebd8453000020efa9055d7896e">IsInitialBlockDownload()</a> const, which latches this for caching purposes. </p>

</div>
</div>
<a id="ad460a678a49106417e68b5c416afd371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad460a678a49106417e68b5c416afd371">&#9670;&nbsp;</a></span>m_chain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/dba/classCChain.html">CChain</a> CChainState::m_chain</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The current chain of blockheaders we consult and build on. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d8/dba/classCChain.html">CChain</a>, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>. </dd></dl>

</div>
</div>
<a id="a7de325123fd907fea8398fde92e5a6b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7de325123fd907fea8398fde92e5a6b1">&#9670;&nbsp;</a></span>m_cs_chainstate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d6b/sync_8h.html#a8019a4144dc54f3a305830f7abd2dbc1">CCriticalSection</a> CChainState::m_cs_chainstate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the ChainState CriticalSection A lock that must be held when modifying this ChainState - held in <a class="el" href="../../d3/d9b/classCChainState.html#ada8c69693e2a23c13cf7bbc568435bef">ActivateBestChain()</a> </p>

</div>
</div>
<a id="a52c29388d6805442893089beaf96c4a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52c29388d6805442893089beaf96c4a7">&#9670;&nbsp;</a></span>m_failed_blocks</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>*&gt; CChainState::m_failed_blocks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>In order to efficiently track invalidity of headers, we keep the set of blocks which we tried to connect and found to be invalid here (ie which were set to BLOCK_FAILED_VALID since the last restart). We can then walk this set and check if a new header is a descendant of something in this set, preventing us from having to walk mapBlockIndex when we try to connect a bad block and fail.</p>
<p>While this is more complicated than marking everything which descends from an invalid block as invalid at the time we discover it to be invalid, doing so would require walking all of mapBlockIndex to find all descendants. Since this case should be very rare, keeping track of all BLOCK_FAILED_VALID blocks in a set should be just fine and work just as well.</p>
<p>Because we already walk mapBlockIndex in height-order at startup, we go ahead and mark descendants of invalid blocks as FAILED_CHILD at that time, instead of putting things in this set. </p>

</div>
</div>
<a id="a318040c11336b79eddc71e1d3b176f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a318040c11336b79eddc71e1d3b176f2a">&#9670;&nbsp;</a></span>mapBlocksUnlinked</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::multimap&lt;<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>*, <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>*&gt; CChainState::mapBlocksUnlinked</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaf4846ebb330ea7ad36adb058ba2b859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf4846ebb330ea7ad36adb058ba2b859">&#9670;&nbsp;</a></span>nBlockReverseSequenceId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> CChainState::nBlockReverseSequenceId = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decreasing counter (used by subsequent preciousblock calls). </p>

</div>
</div>
<a id="a04c18ee587d1d516d12a193235eeb1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c18ee587d1d516d12a193235eeb1cd">&#9670;&nbsp;</a></span>nBlockSequenceId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/dd8/stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a> CChainState::nBlockSequenceId = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Blocks loaded from disk are assigned id 0, so start the counter at 1. </p>

</div>
</div>
<a id="a11b2d82dd158e9e50136417c0e672947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11b2d82dd158e9e50136417c0e672947">&#9670;&nbsp;</a></span>nLastPreciousChainwork</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/de4/classarith__uint256.html">arith_uint256</a> CChainState::nLastPreciousChainwork = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>chainwork for the last block that preciousblock has been applied to. </p>

</div>
</div>
<a id="ae0ae491f2e6b031587a5ad35fdafe546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ae491f2e6b031587a5ad35fdafe546">&#9670;&nbsp;</a></span>pindexBestInvalid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>* CChainState::pindexBestInvalid = nullptr</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a528c14be4a2a7c6837a2d099b2ad7ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528c14be4a2a7c6837a2d099b2ad7ef7">&#9670;&nbsp;</a></span>setBlockIndexCandidates</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a>*, <a class="el" href="../../df/dd8/structCBlockIndexWorkComparator.html">CBlockIndexWorkComparator</a>&gt; CChainState::setBlockIndexCandidates</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The set of all <a class="el" href="../../d8/df0/classCBlockIndex.html">CBlockIndex</a> entries with BLOCK_VALID_TRANSACTIONS (for itself and all ancestors) and as good as our current tip or better. Entries may be failed, though, and pruning nodes may be missing the data for the block. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="../../db/d38/validation_8h_source.html">validation.h</a></li>
<li>src/<a class="el" href="../../dd/d7d/validation_8cpp.html">validation.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
