<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin: src/secp256k1/src/modules/schnorrsig/main_impl.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_44f34d1e62fda08bdb4ca69ab2d205ae.html">secp256k1</a></li><li class="navelem"><a class="el" href="../../dir_8db2ef784512d48b2a7d00369dfaac28.html">src</a></li><li class="navelem"><a class="el" href="../../dir_403fe05abfd2d392aa3c0b8c300f7bf6.html">modules</a></li><li class="navelem"><a class="el" href="../../dir_ab996d31fbe6f08bc000dc8dbcb734ee.html">schnorrsig</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">main_impl.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d7/dd3/secp256k1_8h_source.html">include/secp256k1.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d6f/secp256k1__schnorrsig_8h_source.html">include/secp256k1_schnorrsig.h</a>&quot;</code><br />
<code>#include &quot;hash.h&quot;</code><br />
</div>
<p><a href="../../db/d73/schnorrsig_2main__impl_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d7d/structsecp256k1__schnorrsig__verify__ecmult__context.html">secp256k1_schnorrsig_verify_ecmult_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3854c561103ab47503de8815f9b95a45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#a3854c561103ab47503de8815f9b95a45">secp256k1_schnorrsig_serialize</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, unsigned char *out64, const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *sig)</td></tr>
<tr class="separator:a3854c561103ab47503de8815f9b95a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa4094fb1f61a7b4c3a5ca9e74029f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#aaaa4094fb1f61a7b4c3a5ca9e74029f0">secp256k1_schnorrsig_parse</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *sig, const unsigned char *in64)</td></tr>
<tr class="separator:aaaa4094fb1f61a7b4c3a5ca9e74029f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af94dfd0dfb54fa075e1ba26c5fb3531d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#af94dfd0dfb54fa075e1ba26c5fb3531d">secp256k1_schnorrsig_sign</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *sig, int *nonce_is_negated, const unsigned char *msg32, const unsigned char *seckey, <a class="el" href="../../d7/dd3/secp256k1_8h.html#a539882fd91bff672712fa19a4cfaeb98">secp256k1_nonce_function</a> noncefp, void *ndata)</td></tr>
<tr class="separator:af94dfd0dfb54fa075e1ba26c5fb3531d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a635680a983cfe02df1c688ebf24e6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#a64a635680a983cfe02df1c688ebf24e6">secp256k1_schnorrsig_real_verify</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, <a class="el" href="../../d9/dd1/structsecp256k1__gej.html">secp256k1_gej</a> *rj, const <a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *s, const <a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *e, const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *pk)</td></tr>
<tr class="separator:a64a635680a983cfe02df1c688ebf24e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d31227a25d0bbeb61b93d0f361a93a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#a30d31227a25d0bbeb61b93d0f361a93a">secp256k1_schnorrsig_verify</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *sig, const unsigned char *msg32, const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *pk)</td></tr>
<tr class="separator:a30d31227a25d0bbeb61b93d0f361a93a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12d87737b9cac18bd04e7335c625c345"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#a12d87737b9cac18bd04e7335c625c345">secp256k1_schnorrsig_verify_batch_ecmult_callback</a> (<a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *sc, <a class="el" href="../../d0/dbb/structsecp256k1__ge.html">secp256k1_ge</a> *pt, size_t idx, void *data)</td></tr>
<tr class="separator:a12d87737b9cac18bd04e7335c625c345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fced9ef5cf3d17c1cd9da7a486bdb6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#ae2fced9ef5cf3d17c1cd9da7a486bdb6">secp256k1_schnorrsig_verify_batch_init_randomizer</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, <a class="el" href="../../d3/d7d/structsecp256k1__schnorrsig__verify__ecmult__context.html">secp256k1_schnorrsig_verify_ecmult_context</a> *ecmult_context, <a class="el" href="../../d3/d02/structsecp256k1__sha256.html">secp256k1_sha256</a> *sha, const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *sig, const unsigned char *const *msg32, const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *const *pk, size_t n_sigs)</td></tr>
<tr class="separator:ae2fced9ef5cf3d17c1cd9da7a486bdb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f75edba7a276b0f45a5975d94e2740"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#aa2f75edba7a276b0f45a5975d94e2740">secp256k1_schnorrsig_verify_batch_sum_s</a> (<a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *s, unsigned char *chacha_seed, const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *sig, size_t n_sigs)</td></tr>
<tr class="separator:aa2f75edba7a276b0f45a5975d94e2740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae686447f0f3581140b69981f44416d8a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d73/schnorrsig_2main__impl_8h.html#ae686447f0f3581140b69981f44416d8a">secp256k1_schnorrsig_verify_batch</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, <a class="el" href="../../d6/dd4/scratch_8h.html#a60f82da306d5fc9adeb3f892f3ca7ee3">secp256k1_scratch</a> *scratch, const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *sig, const unsigned char *const *msg32, const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *const *pk, size_t n_sigs)</td></tr>
<tr class="separator:ae686447f0f3581140b69981f44416d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aaaa4094fb1f61a7b4c3a5ca9e74029f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaa4094fb1f61a7b4c3a5ca9e74029f0">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_parse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>in64</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parse a Schnorr signature.</p>
<p>Returns: 1 when the signature could be parsed, 0 otherwise. Args: ctx: a secp256k1 context object Out: sig: pointer to a signature object In: in64: pointer to the 64-byte signature to be parsed</p>
<p>The signature is serialized in the form R||s, where R is a 32-byte public key (x-coordinate only; the y-coordinate is considered to be the unique y-coordinate satisfying the curve equation that is a quadratic residue) and s is a 32-byte big-endian scalar.</p>
<p>After the call, sig will always be initialized. If parsing failed or the encoded numbers are out of range, signature validation with it is guaranteed to fail for every message and public key. </p>

</div>
</div>
<a id="a64a635680a983cfe02df1c688ebf24e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a635680a983cfe02df1c688ebf24e6">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_real_verify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_schnorrsig_real_verify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/dd1/structsecp256k1__gej.html">secp256k1_gej</a> *&#160;</td>
          <td class="paramname"><em>rj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *&#160;</td>
          <td class="paramname"><em>pk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3854c561103ab47503de8815f9b95a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3854c561103ab47503de8815f9b95a45">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_serialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out64</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *&#160;</td>
          <td class="paramname"><em>sig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Serialize a Schnorr signature.</p>
<p>Returns: 1 Args: ctx: a secp256k1 context object Out: out64: pointer to a 64-byte array to store the serialized signature In: sig: pointer to the signature</p>
<p>See secp256k1_schnorrsig_parse for details about the encoding. </p>

</div>
</div>
<a id="af94dfd0dfb54fa075e1ba26c5fb3531d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af94dfd0dfb54fa075e1ba26c5fb3531d">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_sign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>nonce_is_negated</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>msg32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dd3/secp256k1_8h.html#a539882fd91bff672712fa19a4cfaeb98">secp256k1_nonce_function</a>&#160;</td>
          <td class="paramname"><em>noncefp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ndata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a Schnorr signature.</p>
<p>Returns 1 on success, 0 on failure. Args: ctx: pointer to a context object, initialized for signing (cannot be NULL) Out: sig: pointer to the returned signature (cannot be NULL) nonce_is_negated: a pointer to an integer indicates if signing algorithm negated the nonce (can be NULL) In: msg32: the 32-byte message hash being signed (cannot be NULL) seckey: pointer to a 32-byte secret key (cannot be NULL) noncefp: pointer to a nonce generation function. If NULL, secp256k1_nonce_function_bipschnorr is used ndata: pointer to arbitrary data used by the nonce generation function (can be NULL) </p>

</div>
</div>
<a id="a30d31227a25d0bbeb61b93d0f361a93a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30d31227a25d0bbeb61b93d0f361a93a">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_verify </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>msg32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *&#160;</td>
          <td class="paramname"><em>pubkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify a Schnorr signature.</p>
<p>Returns: 1: correct signature 0: incorrect or unparseable signature Args: ctx: a secp256k1 context object, initialized for verification. In: sig: the signature being verified (cannot be NULL) msg32: the 32-byte message hash being verified (cannot be NULL) pubkey: pointer to a public key to verify with (cannot be NULL) </p>

</div>
</div>
<a id="ae686447f0f3581140b69981f44416d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae686447f0f3581140b69981f44416d8a">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_verify_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int secp256k1_schnorrsig_verify_batch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dd3/secp256k1_8h.html#a13c17a5e196534c7df988c0aa6e5a6fa">secp256k1_scratch_space</a> *&#160;</td>
          <td class="paramname"><em>scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *const *&#160;</td>
          <td class="paramname"><em>msg32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *const *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_sigs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verifies a set of Schnorr signatures.</p>
<p>Returns 1 if all succeeded, 0 otherwise. In particular, returns 1 if n_sigs is 0.</p>
<p>Args: ctx: a secp256k1 context object, initialized for verification. scratch: scratch space used for the multiexponentiation In: sig: array of signatures, or NULL if there are no signatures msg32: array of messages, or NULL if there are no signatures pk: array of public keys, or NULL if there are no signatures n_sigs: number of signatures in above arrays. Must be smaller than 2^31 and smaller than half the maximum size_t value. Must be 0 if above arrays are NULL. </p>

</div>
</div>
<a id="a12d87737b9cac18bd04e7335c625c345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12d87737b9cac18bd04e7335c625c345">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_verify_batch_ecmult_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_schnorrsig_verify_batch_ecmult_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/dbb/structsecp256k1__ge.html">secp256k1_ge</a> *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae2fced9ef5cf3d17c1cd9da7a486bdb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2fced9ef5cf3d17c1cd9da7a486bdb6">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_verify_batch_init_randomizer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_schnorrsig_verify_batch_init_randomizer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d7d/structsecp256k1__schnorrsig__verify__ecmult__context.html">secp256k1_schnorrsig_verify_ecmult_context</a> *&#160;</td>
          <td class="paramname"><em>ecmult_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d02/structsecp256k1__sha256.html">secp256k1_sha256</a> *&#160;</td>
          <td class="paramname"><em>sha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *const *&#160;</td>
          <td class="paramname"><em>msg32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/dde/structsecp256k1__pubkey.html">secp256k1_pubkey</a> *const *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_sigs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function for batch verification. Hashes signature verification data into the randomization seed and initializes ecmult_context.</p>
<p>Returns 1 if the randomizer was successfully initialized.</p>
<p>Args: ctx: a secp256k1 context object Out: ecmult_context: context for batch_ecmult_callback In/Out sha: an initialized sha256 object which hashes the schnorrsig input in order to get a seed for the randomizer PRNG In: sig: array of signatures, or NULL if there are no signatures msg32: array of messages, or NULL if there are no signatures pk: array of public keys, or NULL if there are no signatures n_sigs: number of signatures in above arrays (must be 0 if they are NULL) </p>

</div>
</div>
<a id="aa2f75edba7a276b0f45a5975d94e2740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f75edba7a276b0f45a5975d94e2740">&#9670;&nbsp;</a></span>secp256k1_schnorrsig_verify_batch_sum_s()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int secp256k1_schnorrsig_verify_batch_sum_s </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d44/structsecp256k1__scalar.html">secp256k1_scalar</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>chacha_seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/d14/structsecp256k1__schnorrsig.html">secp256k1_schnorrsig</a> *const *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_sigs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function for batch verification. Sums the s part of all signatures multiplied by their randomizer.</p>
<p>Returns 1 if s is successfully summed.</p>
<p>In/Out: s: the s part of the input sigs is added to this s argument In: chacha_seed: PRNG seed for computing randomizers sig: array of signatures, or NULL if there are no signatures n_sigs: number of signatures in above array (must be 0 if they are NULL) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
