<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bitcoin: src/key.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bitcoin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">key.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="../../de/de5/key_8h_source.html">key.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../dc/d54/common_8h_source.html">crypto/common.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d3/d2b/hmac__sha512_8h_source.html">crypto/hmac_sha512.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d1/d79/random_8h_source.html">random.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d7/dd3/secp256k1_8h_source.html">secp256k1.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d9/d84/secp256k1__recovery_8h_source.html">secp256k1_recovery.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4b55d97662f6589a6319c363469c501e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#a4b55d97662f6589a6319c363469c501e">ec_privkey_import_der</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, unsigned char *out32, const unsigned char *privkey, size_t privkeylen)</td></tr>
<tr class="separator:a4b55d97662f6589a6319c363469c501e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab065cee6486804693ab10b1694ea002f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#ab065cee6486804693ab10b1694ea002f">ec_privkey_export_der</a> (const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *<a class="el" href="../../d5/d7f/tests_8c.html#a06a3e29ada83211a695a49e8f7405842">ctx</a>, unsigned char *privkey, size_t *privkeylen, const unsigned char *key32, bool compressed)</td></tr>
<tr class="separator:ab065cee6486804693ab10b1694ea002f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ec599027c6b68a87ebd788be2a611c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#ac9ec599027c6b68a87ebd788be2a611c">SigHasLowR</a> (const <a class="el" href="../../d1/df3/structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a> *sig)</td></tr>
<tr class="separator:ac9ec599027c6b68a87ebd788be2a611c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8d142f5bcd2ca6646462fb45a7945d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#adc8d142f5bcd2ca6646462fb45a7945d">ECC_InitSanityCheck</a> ()</td></tr>
<tr class="separator:adc8d142f5bcd2ca6646462fb45a7945d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d2893f2f5af1cca247516578171860"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#ae4d2893f2f5af1cca247516578171860">ECC_Start</a> ()</td></tr>
<tr class="separator:ae4d2893f2f5af1cca247516578171860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3410be5ada18a4d8e9edcd3b0d261c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#af3410be5ada18a4d8e9edcd3b0d261c9">ECC_Stop</a> ()</td></tr>
<tr class="separator:af3410be5ada18a4d8e9edcd3b0d261c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa353374fd6a64d469d7d2f3540f8ac76"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dbc/key_8cpp.html#aa353374fd6a64d469d7d2f3540f8ac76">secp256k1_context_sign</a> = nullptr</td></tr>
<tr class="separator:aa353374fd6a64d469d7d2f3540f8ac76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab065cee6486804693ab10b1694ea002f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab065cee6486804693ab10b1694ea002f">&#9670;&nbsp;</a></span>ec_privkey_export_der()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ec_privkey_export_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>privkeylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compressed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This serializes to a DER encoding of the ECPrivateKey type from section C.4 of SEC 1 <a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>. The optional parameters and publicKey fields are included.</p>
<p>privkey must point to an output buffer of length at least <a class="el" href="../../d0/dc4/classCKey.html#ae933097e3433e9f26c41aeff057997c6">CKey::PRIVATE_KEY_SIZE</a> bytes. privkeylen must initially be set to the size of the privkey buffer. Upon return it will be set to the number of bytes used in the buffer. key32 must point to a 32-byte raw private key. </p>

</div>
</div>
<a id="a4b55d97662f6589a6319c363469c501e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b55d97662f6589a6319c363469c501e">&#9670;&nbsp;</a></span>ec_privkey_import_der()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ec_privkey_import_der </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out32</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>privkeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>These functions are taken from the libsecp256k1 distribution and are very ugly. This parses a format loosely based on a DER encoding of the ECPrivateKey type from section C.4 of SEC 1 <a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>, with the following caveats:</p>
<ul>
<li>The octet-length of the SEQUENCE must be encoded as 1 or 2 octets. It is not required to be encoded as one octet if it is less than 256, as DER would require.</li>
<li>The octet-length of the SEQUENCE must not be greater than the remaining length of the key encoding, but need not match it (i.e. the encoding may contain junk after the encoded SEQUENCE).</li>
<li>The privateKey OCTET STRING is zero-filled on the left to 32 octets.</li>
<li>Anything after the encoding of the privateKey OCTET STRING is ignored, whether or not it is validly encoded DER.</li>
</ul>
<p>out32 must point to an output buffer of length at least 32 bytes. </p>

</div>
</div>
<a id="adc8d142f5bcd2ca6646462fb45a7945d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8d142f5bcd2ca6646462fb45a7945d">&#9670;&nbsp;</a></span>ECC_InitSanityCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ECC_InitSanityCheck </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check that required EC support is available at runtime. </p>

</div>
</div>
<a id="ae4d2893f2f5af1cca247516578171860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d2893f2f5af1cca247516578171860">&#9670;&nbsp;</a></span>ECC_Start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ECC_Start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the elliptic curve support. May not be called twice without calling ECC_Stop first. </p>

</div>
</div>
<a id="af3410be5ada18a4d8e9edcd3b0d261c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3410be5ada18a4d8e9edcd3b0d261c9">&#9670;&nbsp;</a></span>ECC_Stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ECC_Stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deinitialize the elliptic curve support. No-op if ECC_Start wasn't called first. </p>

</div>
</div>
<a id="ac9ec599027c6b68a87ebd788be2a611c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ec599027c6b68a87ebd788be2a611c">&#9670;&nbsp;</a></span>SigHasLowR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SigHasLowR </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/df3/structsecp256k1__ecdsa__signature.html">secp256k1_ecdsa_signature</a> *&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa353374fd6a64d469d7d2f3540f8ac76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa353374fd6a64d469d7d2f3540f8ac76">&#9670;&nbsp;</a></span>secp256k1_context_sign</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dd3/secp256k1_8h.html#a282ec9e6dfec8c35955c3eb2f7476e5e">secp256k1_context</a>* secp256k1_context_sign = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
